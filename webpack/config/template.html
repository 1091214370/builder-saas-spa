<%
  const { assets_url, heads, bodies, pages, debug, miniAppName, commonAppName } = htmlWebpackPlugin.options
  const version = '?v=' + (+ new Date())
%>
<!DOCTYPE html>
<html lang="zh">

<head>
  <meta charset="utf-8" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  <meta name="format-detection" content="telephone=no" />
  <meta name="format-detection" content="email=no" />
  <link rel="stylesheet" href="https://gw.alipayobjects.com/os/lib/antd/3.20.1/dist/antd.min.css">
  
  <link rel="preload" href="https://gw.alipayobjects.com/os/lib/ali/mini-app-loader/0.0.3-beta.17/dist/mini-app-loader-with-config.system.js" as="script" crossorigin="anonymous">
  <link rel="preload" href="https://gw.alipayobjects.com/os/lib/react/16.8.6/umd/react.development.js" as="script" crossorigin="anonymous">
  <link rel="preload" href="https://gw.alipayobjects.com/os/lib/react-dom/16.8.6/umd/react-dom.development.js" as="script" crossorigin="anonymous">
  <link rel="preload" href="https://gw.alipayobjects.com/os/lib/antd/3.20.1/dist/antd.min.js" as="script" crossorigin="anonymous">
  <link rel="preload" href="https://gw.alipayobjects.com/os/lib/single-spa/4.3.5/lib/system/single-spa.min.js" as="script" crossorigin="anonymous">

  <script src="https://gw.alipayobjects.com/as/g/component/babel-polyfill/6.20.0/polyfill.min.js"></script>
  <script src="https://gw.alipayobjects.com/os/lib/systemjs/4.0.2/dist/system.min.js"></script>
  <script src="https://gw.alipayobjects.com/os/lib/moment/2.24.0/min/moment.min.js"></script>
  <!-- 声明依赖模块路径 -->
  <script type="systemjs-importmap">
    {
      "imports": {
        "MiniAppLoader": "https://gw.alipayobjects.com/os/lib/ali/mini-app-loader/0.0.3-beta.17/dist/mini-app-loader-with-config.system.js",
        "React": "https://gw.alipayobjects.com/os/lib/react/16.8.6/umd/react.development.js",
        "ReactDOM": "https://gw.alipayobjects.com/os/lib/react-dom/16.8.6/umd/react-dom.development.js",
        "antd": "https://gw.alipayobjects.com/os/lib/antd/3.20.1/dist/antd.min.js",
        "singleSpa": "https://gw.alipayobjects.com/os/lib/single-spa/4.3.5/lib/system/single-spa.min.js"
      }
    }
  </script>
  <style>
    html,body {
      height: 100%;
    }
    .microfe-layout {
      display: flex;
      flex-direction: column;
    }
    .microfe-navbar {
      background-color: aliceblue;
    }
    .microfe-body {
      flex: auto;
      display: flex;
    }
    .microfe-menu {
      background-color: antiquewhite;
    }
  </style>
</head>
<body>
  <!-- <%= JSON.stringify(htmlWebpackPlugin, null, 2) %> -->
  <div class="microfe-layout">
    <div class="microfe-navbar" id="<%- commonAppName %>__navbar"></div>
    <div class="microfe-body">
      <div class="microfe-menu" id="<%- commonAppName %>__menu"></div>
      <div id="__microfe-root-content"></div>
    </div>
  </div>
  <script>
      (async function() {
        const MiniAppLoader = (await System.import('MiniAppLoader')).default;

        MiniAppLoader.start({
          routerType: MiniAppLoader.RouterType.hash,
          getAppConfigPath: (appConfigPath) => {
            if (!appConfigPath) {
              throw new Error('Please specify appConfigPath.');
            }
            if (appConfigPath.lastIndexOf('app-config.js') > -1) {
              return appConfigPath;
            }
            return '//g-assets.daily.taobao.net/' + appConfigPath + '/app-config.js';
          },
          apps: [
            {
              appConfigPath: './app-config.js',
            },            
          ],
        });
      }());
  </script>
</body>
</html>